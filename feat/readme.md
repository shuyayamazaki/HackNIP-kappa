1. preprocess relaxation to get 